{% extends "base.html" %} 
{% load static %}
{% load widget_tweaks %}   
{% block content %}
{% comment %} 

admin

edit project
delete project 
view attendance 


# punch in 
# punch out 
# lunch start 
# lunch end 
{% endcomment %}

<!-- Welcome Wrap -->
 <div class="content">
				<div class="card border-0">
					<div class="card-body d-flex align-items-center justify-content-between flex-wrap pb-1">
						<div class="d-flex align-items-center mb-3">
							
							<div class="ms-3">
								<h3 class="mb-2">{{post.project_name}}
                                    {% if user.is_superuser  %}
                                    <a href="{% url 'base:project_delete' post.pk %}" class="edit-icon"><i class="ti ti-trash fs-14"></i></a>
                                    <a href="{% url 'base:project_edit' post.pk %}" class="edit-icon"><i class="ti ti-edit fs-14"></i></a>
                                    {% endif %}
                                </h3>
								<p>{{post.address}}</p>
							</div>
						</div>
                        {% if user.designation != "Worker" %}
						<div class="d-flex align-items-center flex-wrap mb-1">
             <a href="{% url 'base:inspection' post.pk %}" class="btn btn-primary btn-md me-2 mb-2" ><i class="ti ti-square-rounded-plus me-1"></i>Add Inspection Details</a>
             <a href="{% url 'base:daily_workers' post.pk %}" class="btn btn-secondary btn-md me-2 mb-2" ><i class="ti ti-square-rounded-plus me-1"></i>Add Worker Details</a>
             <a href="{% url 'base:daily_workers_list' post.pk %}" class="btn btn-success btn-md mb-2" ><i class="ti ti-eye me-1"></i>View Worker Details</a>

						</div>
                        {% endif %}
					</div>
				</div>
				<!-- /Welcome Wrap -->
                  <div class="row">
    <div class="col-xl-4 d-flex">
      <div class="card flex-fill border-primary attendance-bg">
        <div class="card-body">
          <div class="mb-4 text-center">
            <h6 class="fw-medium text-gray-5 mb-1">Attendance</h6>
            <h4>08:35 AM, 11 Mar 2025</h4>
          </div>
        
          <div class="text-center">
            <div class="badge badge-dark badge-md mb-3">
              Production : 3.45 hrs
            </div>
            <h6
              class="fw-medium d-flex align-items-center justify-content-center mb-4"
            >
              <i class="ti ti-fingerprint text-primary me-1"></i>
              Punch In at 10.00 AM
            </h6>
            {% if not att.punch_in %}
            <form action="{% url 'base:punch_in' post.pk %}" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="drag-upload-btn btn btn-primary py-2 w-100 disabled btn-submit">
                <i class="fas fa-spinner fa-spin me-2"></i> Punch In
                <input type="file" name="image" onchange="form.submit()" class="form-control image-sign" accept="image/*" capture="user">
              </div>
              <input type="hidden" name="lat"  id="lat">
              <input type="hidden" name="lon" id="lon" >
            </form>
            {% elif not att.lunch_start %}
                   <form action="{% url 'base:lunch_start' post.pk %}" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="drag-upload-btn btn btn-primary py-2 w-100 disabled btn-submit">
                <i class="fas fa-spinner fa-spin me-2"></i> Lunch Start
                <input type="file" name="image" onchange="form.submit()" class="form-control image-sign" accept="image/*" capture="user">
              </div>
              <input type="hidden" name="lat"  id="lat">
              <input type="hidden" name="lon" id="lon" >
            </form>
            {% elif not att.lunch_end %}
                   <form action="{% url 'base:lunch_end' post.pk %}" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="drag-upload-btn btn btn-primary py-2 w-100 disabled btn-submit">
                <i class="fas fa-spinner fa-spin me-2"></i> Lunch End
                <input type="file" name="image" onchange="form.submit()" class="form-control image-sign" accept="image/*" capture="user">
              </div>
              <input type="hidden" name="lat"  id="lat">
              <input type="hidden" name="lon" id="lon" >
            </form>
            {% elif not att.punch_out %}
                   <form action="{% url 'base:punch_out' post.pk %}" method="POST" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="drag-upload-btn btn btn-primary py-2 w-100 disabled btn-submit">
                <i class="fas fa-spinner fa-spin me-2"></i> Punch Out
                <input type="file" name="image" onchange="form.submit()" class="form-control image-sign" accept="image/*" capture="user">
              </div>
              <input type="hidden" name="lat"  id="lat">
              <input type="hidden" name="lon" id="lon" >
            </form>
            {% else %}
                <p>You have completed today's attendance.</p>
            {% endif %}

          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-8 d-flex">
      <div class="row flex-fill">
        <div class="col-xl-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <div class="border-bottom mb-3 pb-2">
                <span class="avatar avatar-sm bg-primary mb-2"
                  ><i class="ti ti-clock-stop"></i
                ></span>
                <h2 class="mb-2">
                  8.36 / <span class="fs-20 text-gray-5"> 9</span>
                </h2>
                <p class="fw-medium text-truncate">Total Hours Today</p>
              </div>
              <div>
                <p class="d-flex align-items-center fs-13">
                  <span
                    class="avatar avatar-xs rounded-circle bg-success flex-shrink-0 me-2"
                  >
                    <i class="ti ti-arrow-up fs-12"></i>
                  </span>
                  <span>5% This Week</span>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <div class="border-bottom mb-3 pb-2">
                <span class="avatar avatar-sm bg-dark mb-2"
                  ><i class="ti ti-clock-up"></i
                ></span>
                <h2 class="mb-2">
                  10 / <span class="fs-20 text-gray-5"> 40</span>
                </h2>
                <p class="fw-medium text-truncate">Total Hours Week</p>
              </div>
              <div>
                <p class="d-flex align-items-center fs-13">
                  <span
                    class="avatar avatar-xs rounded-circle bg-success flex-shrink-0 me-2"
                  >
                    <i class="ti ti-arrow-up fs-12"></i>
                  </span>
                  <span>7% Last Week</span>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <div class="border-bottom mb-3 pb-2">
                <span class="avatar avatar-sm bg-info mb-2"
                  ><i class="ti ti-calendar-up"></i
                ></span>
                <h2 class="mb-2">
                  75 / <span class="fs-20 text-gray-5"> 98</span>
                </h2>
                <p class="fw-medium text-truncate">Total Hours Month</p>
              </div>
              <div>
                <p class="d-flex align-items-center fs-13 text-truncate">
                  <span
                    class="avatar avatar-xs rounded-circle bg-danger flex-shrink-0 me-2"
                  >
                    <i class="ti ti-arrow-down fs-12"></i>
                  </span>
                  <span>8% Last Month</span>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6">
          <div class="card">
            <div class="card-body">
              <div class="border-bottom mb-3 pb-2">
                <span class="avatar avatar-sm bg-pink mb-2"
                  ><i class="ti ti-calendar-star"></i
                ></span>
                <h2 class="mb-2">
                  16 / <span class="fs-20 text-gray-5"> 28</span>
                </h2>
                <p class="fw-medium text-truncate">Overtime this Month</p>
              </div>
              <div>
                <p class="d-flex align-items-center fs-13 text-truncate">
                  <span
                    class="avatar avatar-xs rounded-circle bg-danger flex-shrink-0 me-2"
                  >
                    <i class="ti ti-arrow-down fs-12"></i>
                  </span>
                  <span>6% Last Month</span>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-12">
          <div class="card">
            <div class="card-body">
              <div class="row">
                <div class="col-xl-3">
                  <div class="mb-4">
                    <p class="d-flex align-items-center mb-1">
                      <i
                        class="ti ti-point-filled text-dark-transparent me-1"
                      ></i
                      >Total Working hours
                    </p>
                    <h3>12h 36m</h3>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="mb-4">
                    <p class="d-flex align-items-center mb-1">
                      <i class="ti ti-point-filled text-success me-1"></i
                      >Productive Hours
                    </p>
                    <h3>08h 36m</h3>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="mb-4">
                    <p class="d-flex align-items-center mb-1">
                      <i class="ti ti-point-filled text-warning me-1"></i>Break
                      hours
                    </p>
                    <h3>22m 15s</h3>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="mb-4">
                    <p class="d-flex align-items-center mb-1">
                      <i class="ti ti-point-filled text-info me-1"></i>Overtime
                    </p>
                    <h3>02h 15m</h3>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <div
                    class="progress bg-transparent-dark mb-3"
                    style="height: 24px"
                  >
                    <div
                      class="progress-bar bg-white rounded"
                      role="progressbar"
                      style="width: 18%"
                    ></div>
                    <div
                      class="progress-bar bg-success rounded me-2"
                      role="progressbar"
                      style="width: 18%"
                    ></div>
                    <div
                      class="progress-bar bg-warning rounded me-2"
                      role="progressbar"
                      style="width: 5%"
                    ></div>
                    <div
                      class="progress-bar bg-success rounded me-2"
                      role="progressbar"
                      style="width: 28%"
                    ></div>
                    <div
                      class="progress-bar bg-warning rounded me-2"
                      role="progressbar"
                      style="width: 17%"
                    ></div>
                    <div
                      class="progress-bar bg-success rounded me-2"
                      role="progressbar"
                      style="width: 22%"
                    ></div>
                    <div
                      class="progress-bar bg-warning rounded me-2"
                      role="progressbar"
                      style="width: 5%"
                    ></div>
                    <div
                      class="progress-bar bg-info rounded me-2"
                      role="progressbar"
                      style="width: 3%"
                    ></div>
                    <div
                      class="progress-bar bg-info rounded"
                      role="progressbar"
                      style="width: 2%"
                    ></div>
                    <div
                      class="progress-bar bg-white rounded"
                      role="progressbar"
                      style="width: 18%"
                    ></div>
                  </div>
                </div>
                <div class="co-md-12">
                  <div
                    class="d-flex align-items-center justify-content-between flex-wrap row-gap-2"
                  >
                    <span class="fs-10">06:00</span>
                    <span class="fs-10">07:00</span>
                    <span class="fs-10">08:00</span>
                    <span class="fs-10">09:00</span>
                    <span class="fs-10">10:00</span>
                    <span class="fs-10">11:00</span>
                    <span class="fs-10">12:00</span>
                    <span class="fs-10">01:00</span>
                    <span class="fs-10">02:00</span>
                    <span class="fs-10">03:00</span>
                    <span class="fs-10">04:00</span>
                    <span class="fs-10">05:00</span>
                    <span class="fs-10">06:00</span>
                    <span class="fs-10">07:00</span>
                    <span class="fs-10">08:00</span>
                    <span class="fs-10">09:00</span>
                    <span class="fs-10">10:00</span>
                    <span class="fs-10">11:00</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% if user.designation != "Worker" %}

  <div class="row">
					<div class="col-xl-3 col-md-6">
						<div  class="card position-relative">
							<div class="card-body">
								<div class="d-flex align-items-center mb-3">
									<div class="avatar avatar-md br-10 icon-rotate bg-primary flex-shrink-0">
										<span class="d-flex align-items-center"><i class="ti ti-delta text-white fs-16"></i></span>
									</div>
									<div class="ms-3">
										
										<h5>Suppler Inventory</h5>
									</div>
								</div>
								<div class="progress progress-xs mb-2">
									<div class="progress-bar bg-primary" role="progressbar" style="width: 100%"></div>
								</div>
                                	<div class="btn-list mt-3 text-end">
									<a href="{% url 'base:add_inventory' post.pk %}" class="btn btn-primary col-5">Add</a>
									
									<a href="{% url 'base:add_inventory_more' post.pk %}" class="btn btn-success col-5">View</a>
								</div>
								
								<span class="position-absolute top-0 end-0"><img src="{% static "img/bg/card-bg-04.png" %}"  alt="Img"></span>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card position-relative">
							<div class="card-body">
								<div class="d-flex align-items-center mb-3">
									<div class="avatar avatar-md br-10 icon-rotate bg-secondary flex-shrink-0">
										<span class="d-flex align-items-center"><i class="ti ti-currency text-white fs-16"></i></span>
									</div>
									<div class="ms-3">
										<h5>Use Inventory</h5>
									</div>
								</div>
								<div class="progress progress-xs mb-2">
									<div class="progress-bar bg-secondary" role="progressbar" style="width: 100%"></div>
								</div>
								  	<div class="btn-list mt-3 text-end">
									<a href="{% url 'base:used_inventory' post.pk %}" class="btn btn-primary col-5">Use</a>
									
									<a href="{% url 'base:used_inventory_more' post.pk %}" class="btn btn-success col-5">View</a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card position-relative">
							<div class="card-body">
								<div class="d-flex align-items-center mb-3">
									<div class="avatar avatar-md br-10 icon-rotate bg-danger flex-shrink-0">
										<span class="d-flex align-items-center"><i class="ti ti-stairs-up text-white fs-16"></i></span>
									</div>
									<div class="ms-3">
										<h5>In Stock Inventory</h5>
									</div>
								</div>
								<div class="progress progress-xs mb-2">
									<div class="progress-bar bg-pink" role="progressbar" style="width: 100%"></div>
								</div>
									<div class="btn-list mt-3 text-end">
									<a href="{% url 'base:in_stock_inventory' post.pk %}" class="btn btn-primary col-5">Update</a>
									
									<a href="{% url 'base:in_stock_inventory_more' post.pk %}" class="btn btn-success col-5">View</a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card position-relative">
							<div class="card-body">
								<div class="d-flex align-items-center mb-3">
									<div class="avatar avatar-md br-10 icon-rotate bg-purple flex-shrink-0">
										<span class="d-flex align-items-center"><i class="ti ti-users-group text-white fs-16"></i></span>
									</div>
									<div class="ms-3">
										<h5>Inspection</h5>
									</div>
								</div>
								<div class="progress progress-xs mb-2">
									<div class="progress-bar bg-purple" role="progressbar" style="width: 100%"></div>
								</div>
									<div class="btn-list mt-3 text-end">
									<a href="{% url 'base:inspection' post.pk %}" class="btn btn-primary col-5">Add</a>
									
									<a href="{% url 'base:inspection_list' post.pk %}" class="btn btn-success col-5">View</a>
								</div>
							</div>
						</div>
					</div>
				</div>
                
 </div>
{% endif %}
 <script>
   window.onload = function() {
     if ("geolocation" in navigator) {
       navigator.geolocation.getCurrentPosition(showGPSLocation);
      } else {
        gonative.android.geoLocation.promptLocationServices()
      }
    };
    
    function showGPSLocation(position) {
    
      var latitude = position.coords.latitude;
      var longitude = position.coords.longitude; 
      
      document.getElementById("lat").value=latitude   
      document.getElementById("lon").value=longitude   
      let btn=document.querySelector(".btn-submit")
      let spin=document.querySelector(".fa-spin")
      btn.classList.remove("disabled")  
      spin.style.display = "none"; 

    }
  </script>
{% endblock content %}